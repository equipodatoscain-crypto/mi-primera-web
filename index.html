
<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Recepci√≥n de Certificados</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@1.35.7"></script>

<script>
    const SUPABASE_URL = "https://vdsqkhajbfevpgeuvfbd.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZkc3FraGFqYmZldnBnZXV2ZmJkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM2MDg3MTIsImV4cCI6MjA3OTE4NDcxMn0.OexzIcRC_F7pnFijSQGZVpXN1xdsDw8zuGR1gFHTyuI";

    const client = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
    console.log("üîµ Conectado correctamente a Supabase");
</script>

<style>
    body {
        font-family: Arial;
        background: #eef1f7;
        margin: 0;
        padding: 0;
    }

    h1 {
        text-align: center;
        background: #3155ff;
        color: white;
        padding: 20px;
        margin: 0;
        font-size: 26px;
    }

    .container {
        width: 95%;
        max-width: 1100px; 
        margin: 20px auto;
        background: white;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }

    label {
        font-weight: bold;
        margin-top: 10px;
        display: block;
    }

    select, input {
        width: 100%;
        padding: 10px;
        border-radius: 6px;
        border: 1px solid #ccc;
        text-transform: uppercase;
        font-size: 16px;
        box-sizing: border-box;
    }

    .btn {
        width: 100%;
        padding: 12px;
        background: #3155ff;
        color: white;
        border-radius: 6px;
        border: none;
        font-size: 18px;
        cursor: pointer;
        margin-top: 15px;
        transition: background 0.3s;
    }
    
    /* Estilos base de los botones de estado */
    .btn-estado {
        width: 100%;
        padding: 12px;
        border-radius: 6px;
        border: 2px solid transparent; 
        font-size: 18px;
        cursor: pointer;
        font-weight: bold;
        transition: all 0.2s ease-in-out;
    }
    
    /* Estilo para el bot√≥n RECHAZADO (Amarillo) */
    .btn-rechazado {
        background: #ffc107; 
        color: #343a40; 
    }

    /* Estilo para el bot√≥n APROBADO (Verde) */
    .btn-aprobado {
        background: #28a745; 
        color: white;
    }
    
    /* üí• Ajuste de contraste: Cuando el bot√≥n APROBADO est√° seleccionado (AZUL) */
    .btn-aprobado.selected {
        background: #3155ff; /* Color principal azul fuerte */
        color: white;
        border-color: #3155ff;
        box-shadow: 0 0 10px rgba(49, 85, 255, 0.7);
    }

    /* üí• Ajuste de contraste: Cuando el bot√≥n RECHAZADO est√° seleccionado (NARANJA OSCURO) */
    .btn-rechazado.selected {
        background: #e0a800; /* Amarillo/naranja oscuro */
        color: white;
        border-color: #e0a800;
        box-shadow: 0 0 10px rgba(224, 168, 0, 0.7);
    }

    /* Contenedor para los botones de estado */
    .status-buttons {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
        margin-top: 15px;
    }

    #daysContainer { margin-top: 25px; }

    .header-row {
        font-weight: bold;
        padding: 10px 0;
        margin-bottom: 5px;
        border-bottom: 2px solid #3155ff;
        color: #3155ff;
        position: sticky;
        top: 0;
        background-color: white;
        z-index: 10;
        padding-top: 15px;
    }

    .row, .header-row {
        display: grid;
        grid-template-columns: 180px 1fr 1fr 1.5fr; 
        gap: 15px;
        padding-right: 15px;
    }

    .row {
        margin-bottom: 10px;
        padding: 10px;
        border: 1px solid #ddd; 
        border-radius: 8px;
        align-items: center; 
    }

    .row > div:first-child { text-align: center; }

    .msg {
        font-size: 12px;
        color: red;
        margin-top: 2px;
        text-align: left;
    }

    .generalBox {
        width: 100%;
        margin-top: 25px;
        text-transform: uppercase;
    }
</style>

</head>
<body>

<div style="width:95%; max-width:1100px; margin:15px auto 0 auto; text-align:right;">
    <button onclick="window.location.href='reporte.html'" 
            style="background:#28a745; color:white; padding:10px 20px; 
                   border:none; border-radius:6px; font-size:16px; cursor:pointer;">
        üìä REPORTE
    </button>
</div>

<h1>Recepci√≥n de Certificados</h1>

<div class="container">

    <label>Responsable:</label>
    <input id="responsable" placeholder="Nombre de quien registra">
    <div id="errorResp" class="msg"></div>
    
    <label>A√±o:</label>
    <select id="year">
        <option value="">Seleccione a√±o</option>
        <option>2025</option><option>2026</option><option>2027</option>
    </select>
    <div id="errorY" class="msg"></div>

    <label>Mes:</label>
    <select id="month">
        <option value="">Seleccione mes</option>
        <option>Enero</option><option>Febrero</option><option>Marzo</option>
        <option>Abril</option><option>Mayo</option><option>Junio</option>
        <option>Julio</option><option>Agosto</option><option>Septiembre</option>
        <option>Octubre</option><option>Noviembre</option><option>Diciembre</option>
    </select>
    <div id="errorM" class="msg"></div>

    <label>N√∫mero de Contrato - OC:</label>
    <input id="contrato" placeholder="Ejemplo: 143289">
    <div id="errorC" class="msg"></div>

    <label>N√∫mero de Ruta:</label>
    <input id="ruta" placeholder="Ejemplo: U-001">
    <div id="errorR" class="msg"></div>

    <button class="btn" onclick="generarDias()">Generar d√≠as del mes</button>

    <div id="daysContainer"></div>

    <label>Observaci√≥n General:</label>
    <textarea class="generalBox" id="obsGeneral" rows="4" style="resize:none;"></textarea>

    <div id="errorEstado" class="msg" style="margin-top:10px; text-align:center;"></div>

    <div class="status-buttons">
        <button id="btnAprobado" class="btn-estado btn-aprobado" onclick="seleccionarEstado('APROBADO')">
            ‚úî APROBADO
        </button>
        <button id="btnRechazado" class="btn-estado btn-rechazado" onclick="seleccionarEstado('RECHAZADO')">
            ‚ö† RECHAZADO
        </button>
    </div>
    
    <button class="btn" onclick="guardarDatos()">GUARDAR DATOS</button>

</div>

<script>
// üí• Variable global para rastrear el estado seleccionado
let estadoSeleccionado = null; 

const placasValidas = [
"AAA111",
"BBB222",
"CCC333",
"EEE444",
"ELX919",
"EQ0327",
"EQO327",
"EQP016",
"EQP017",
"EQP988",
"EQQ117",
"EQQ121",
"EQQ981",
"EQQ982",
"EQQ983",
"EQQ984",
"EQQ985",
"EQQ986",
"EQQ998",
"EQR115",
"EQR116",
"EQY394",
"EQY716",
"EQY801",
"EQY948",
"EQZ044",
"EQZ063",
"EQZ064",
"EQZ065",
"EQZ066",
"EQZ209",
"EQZ217",
"EQZ485",
"EQZ486",
"EQZ487",
"EQZ488",
"EQZ739",
"EQZ872",
"EQZ877",
"EQZ903",
"EQZ945",
"EQZ946",
"EQZ947",
"EQZ948",
"EQZ949",
"EQZ950",
"EQZ951",
"EQZ953",
"EQZ954",
"EQZ991",
"EQZ992",
"EQZ994",
"EQZ995",
"ERK044",
"ERK045",
"ERK101",
"ERK173",
"ERK426",
"ERK427",
"ERK428",
"ERK429",
"ERK430",
"ERK431",
"ERK785",
"ERK786",
"ERL122",
"ERL123",
"ERL124",
"ERL650",
"ESL157",
"ESM431",
"ESM590",
"ESM603",
"ESM604",
"ESM608",
"ESM609",
"ESM610",
"ESM856",
"ESM982",
"ESR740",
"ESS244",
"ESS424",
"ESS425",
"ESS615",
"ESU195",
"ETM404",
"ETM960",
"ETT120",
"ETT246",
"ETT249",
"ETT472",
"ETT621",
"ETT783",
"ETT814",
"ETT841",
"ETT842",
"ETT889",
"ETT914",
"ETT934",
"ETT935",
"ETT936",
"ETT937",
"ETT938",
"ETT939",
"ETT940",
"ETT946",
"ETT969",
"EXX245",
"EXX395",
"EXX640",
"EXX767",
"EXX768",
"EXX769",
"EXX770",
"EXX851",
"EXX852",
"EXX863",
"EXZ566",
"EXZ568",
"EXZ902",
"EXZ903",
"EXZ904",
"EYX311",
"EYX357",
"EYX713",
"EZQ484",
"FSQ692",
"FSQ694",
"FSQ695",
"FSQ696",
"FSQ882",
"FST210",
"FST211",
"FST212",
"FST213",
"FST214",
"FST247",
"FST249",
"FST266",
"FST267",
"FST854",
"FST944",
"FST960",
"FSU800",
"FSU894",
"FSU895",
"FSU896",
"FSU897",
"FSU898",
"FSU899",
"FSU900",
"FSU901",
"FSU902",
"FSU903",
"FSU904",
"FSU905",
"FSU906",
"FSU907",
"FSU973",
"FSV001",
"FSV051",
"FSV071",
"FSV072",
"FSV073",
"FSV343",
"FSV465",
"FSV503",
"FSV505",
"FSV506",
"FSV507",
"FSV508",
"FSV509",
"FSV510",
"FSV630",
"FSV850",
"FSW186",
"FUZ156",
"FUZ437",
"FVM064",
"FVM165",
"FXU245",
"FXU251",
"FXW135",
"GDU997",
"GET270",
"GET483",
"GET484",
"GET917",
"GET918",
"GET919",
"GET920",
"GET921",
"GET922",
"GET923",
"GET924",
"GET925",
"GEU024",
"GEU312",
"GEU313",
"GEU314",
"GEU524",
"GEU703",
"GEU704",
"GEU716",
"GEU717",
"GIM422",
"GSM110",
"GSM133",
"GTY625",
"GUQ400",
"GUQ777",
"GUQ855",
"GUR327",
"GUR460",
"GUU086",
"GUW199",
"GUX130",
"GVK192",
"GVK193",
"GVK199",
"GVK202",
"GVK205",
"GVK231",
"GVK232",
"GVK240",
"GVK244",
"GZZ701",
"GZZ934",
"IL 623",
"IL 810",
"JKU565",
"JKU900",
"JKU901",
"JKU902",
"JKU903",
"JKU904",
"JKU905",
"JKU955",
"JKU974",
"JKU975",
"JKU976",
"JKU977",
"JKU978",
"JKU979",
"JKV405",
"JKV406",
"JKV613",
"JOU732",
"JOV169",
"JOV186",
"JOV532",
"JTP107",
"JTP626",
"JTP669",
"JTQ095",
"JTQ616",
"JTR365",
"JTR367",
"JUY785",
"JUY991",
"JUZ507",
"JUZ545",
"JVK770",
"JZX347",
"KNL600",
"KNZ219",
"KRL845",
"KSO913",
"KSO915",
"KSP265",
"KSP426",
"KSQ170",
"KYR564",
"KZV688",
"LCM647",
"LCN119",
"LCN846",
"LCN847",
"LCO858",
"LCO859",
"LCO860",
"LGL548",
"LJU154",
"LJU811",
"LJV444",
"LKQ133",
"LKT782",
"LLO985",
"LLP234",
"LLP825",
"LLP826",
"LLP827",
"LLP828",
"LLQ436",
"LLQ437",
"LLQ438",
"LLQ439",
"LLQ440",
"LLQ521",
"LLQ750",
"LLQ751",
"LLQ752",
"LLQ753",
"LLQ754",
"LLQ759",
"LLQ760",
"LLQ761",
"LLQ800",
"LLQ801",
"LLQ804",
"LLQ953",
"LLR283",
"LLR437",
"LMM946",
"LMM947",
"LMM963",
"LPZ905",
"LQK047",
"LQK132",
"LQK274",
"LQK825",
"LQK826",
"LQK827",
"LQK890",
"LQL234",
"LRN087",
"LSX919",
"LSY181",
"LSY424",
"LSY602",
"LSY604",
"LSZ331",
"LSZ479",
"LTK472",
"LUK695",
"LUK946",
"LUL326",
"LUL580",
"LUL581",
"LUL985",
"LUM229",
"LUM252",
"LUM253",
"LUM257",
"LUM613",
"LUM668",
"LUM681",
"LUM682",
"LUM683",
"LUM850",
"LUM851",
"LUM982",
"LUN170",
"LUN558",
"LUX016",
"LUX017",
"LWL340",
"LZL705",
"LZL979",
"LZL980",
"LZM164",
"LZM617",
"LZM875",
"LZN025",
"LZN499",
"LZN833",
"LZO011",
"LZO012",
"LZO013",
"LZO014",
"LZO159",
"LZO640",
"LZO641",
"NHO239",
"NHQ493",
"NHQ494",
"NHQ500",
"NHQ712",
"NHR341",
"NHR420",
"NHR421",
"NHR422",
"NHR551",
"NHT133",
"NHT247",
"NNV119",
"NOK500",
"NOK637",
"NOL107",
"NOL272",
"NOS537",
"NOS614",
"NOS624",
"NOW205",
"NOW215",
"NOW363",
"NOW365",
"NOW563",
"NOW624",
"NOW634",
"NOW645",
"NOW647",
"NOW814",
"NOW989",
"NOW990",
"NOX198",
"NOX199",
"NOX449",
"NOX850",
"NOX851",
"NOX852",
"NOX861",
"NOX884",
"NOX983",
"NOY312",
"NOY445",
"NPR912",
"NSQ552",
"NSY427",
"NSY428",
"NSY429",
"NTQ416",
"NTQ419",
"NTQ420",
"NTQ421",
"NTQ422",
"NTQ423",
"NUV138",
"NUV142",
"NUW427",
"NUW513",
"NUW735",
"NUW766",
"NUW768",
"NUW814",
"NUX072",
"NUX073",
"NUX079",
"NUX080",
"NUX384",
"NUX670",
"NUX683",
"NUX775",
"NUY921",
"NWV645",
"NWV840",
"NWW104",
"NWW198",
"NWW481",
"NWW515",
"NWW608",
"NXY803",
"PKK714",
"PMT708",
"PMT709",
"PMT710",
"PMV580",
"PMV581",
"PMW636",
"PMW637",
"PMW650",
"PMX149",
"PMX150",
"POP049",
"POP142",
"POP193",
"POP219",
"PPQ647",
"PRY729",
"SBL092",
"SBL192",
"SHL152",
"SHT740",
"SIG993",
"SJK587",
"SJQ108",
"SJQ115",
"SKL523",
"SKM201",
"SKM302",
"SKM465",
"SKM740",
"SKM855",
"SKN215",
"SKR611",
"SKY217",
"SKY277",
"SKY427",
"SKY499",
"SKY579",
"SKY681",
"SKY905",
"SKY996",
"SKZ065",
"SKZ075",
"SKZ197",
"SKZ692",
"SKZ776",
"SLE574",
"SLE604",
"SLE606",
"SLE607",
"SLE636",
"SLE684",
"SLE695",
"SLE963",
"SLG164",
"SLG264",
"SLG468",
"SLG908",
"SLG933",
"SLH062",
"SLH291",
"SLI001",
"SLI036",
"SLJ161",
"SLJ267",
"SLJ804",
"SLJ924",
"SLV257",
"SMB477",
"SMB929",
"SMG820",
"SMI984",
"SMJ507",
"SMK608",
"SMK855",
"SMO084",
"SMO531",
"SMO730",
"SMO862",
"SMP070",
"SMP071",
"SMP137",
"SMP231",
"SMP692",
"SMZ945",
"SNQ820",
"SNT679",
"SNW074",
"SOD206",
"SOD636",
"SOE032",
"SOE898",
"SOF314",
"SOI024",
"SOI405",
"SON314",
"SON796",
"SOO037",
"SOO226",
"SOO714",
"SOP031",
"SOP089",
"SOP244",
"SOP276",
"SOP582",
"SOP738",
"SOQ089",
"SOQ241",
"SOQ282",
"SOQ472",
"SOQ562",
"SOQ568",
"SOQ676",
"SOR475",
"SOR536",
"SOR714",
"SOS354",
"SOS713",
"SPD442",
"SPD475",
"SPL520",
"SPL585",
"SPL604",
"SPL640",
"SPL730",
"SPM307",
"SPM354",
"SPM356",
"SPM606",
"SPN348",
"SPN837",
"SPN838",
"SPN875",
"SPN877",
"SPN878",
"SPO350",
"SPO452",
"SPO859",
"SPO946",
"SPP138",
"SPP271",
"SPP432",
"SPP564",
"SPP586",
"SPP676",
"SPP725",
"SPQ282",
"SPQ536",
"SPR052",
"SPR949",
"SPS172",
"SPS183",
"SPS221",
"SPS425",
"SPT208",
"SPT486",
"SPT522",
"SPT523",
"SPT608",
"SPT678",
"SPU247",
"SPU504",
"SPU510",
"SPV033",
"SPV331",
"SPW267",
"SPX035",
"SPX093",
"SPX644",
"SPX793",
"SPX859",
"SPY048",
"SQD781",
"SQI481",
"SQW478",
"SQW697",
"SQW795",
"SQX455",
"SQX685",
"SQX716",
"SQZ448",
"SRF472",
"SRL192",
"SSP983",
"SST331",
"SSZ440",
"STQ115",
"STQ189",
"STR617",
"SVC039",
"SVC187",
"SVC192",
"SVF474",
"SVO670",
"SVP136",
"SWK040",
"SWL568",
"SWL748",
"SWO192",
"SWO229",
"SWO918",
"SWQ181",
"SWS122",
"SWS351",
"SXB756",
"SXD858",
"SXR093",
"SXR948",
"SXT189",
"SXT689",
"SXT692",
"SXX137",
"SXX258",
"SXX645",
"SXX856",
"SXX861",
"SXX864",
"SXY321",
"SXY445",
"SXZ186",
"SYS201",
"SYU400",
"SYU856",
"SZL751",
"SZM206",
"SZM863",
"SZN546",
"SZO798",
"SZO927",
"SZO969",
"SZP252",
"SZP863",
"SZQ199",
"SZQ377",
"SZQ382",
"SZS250",
"SZT475",
"SZU320",
"SZU464",
"SZU516",
"SZX392",
"SZX963",
"SZY629",
"SZZ993",
"TAL232",
"TAL825",
"TAM027",
"TAM249",
"TAM259",
"TAM816",
"TAM888",
"TAM997",
"TAN085",
"TAQ138",
"TAQ143",
"TAQ149",
"TAQ150",
"TAQ152",
"TAQ154",
"TAQ218",
"TAQ470",
"TAR451",
"TAT807",
"TAW069",
"TBZ386",
"TBZ875",
"TBZ882",
"TDK067",
"TDK632",
"TDL188",
"TDL311",
"TDL922",
"TDS132",
"TDS133",
"TDS138",
"TDS269",
"TDS270",
"TDS323",
"TDS505",
"TDS511",
"TDS512",
"TDS514",
"TDS830",
"TDU819",
"TDW021",
"TER265",
"TES229",
"TEW113",
"TFP479",
"TFQ460",
"TFT588",
"TFT780",
"TFT783",
"TFT920",
"TFU317",
"TFU337",
"TFU338",
"TFU342",
"TFU343",
"TFU948",
"TFW593",
"TFW773",
"TFW887",
"TGK020",
"TGK114",
"TGK200",
"TGK298",
"TGK364",
"TGK631",
"TGK637",
"TGK650",
"TGK729",
"TGK769",
"TGL024",
"TGL239",
"TGL437",
"TGL601",
"TGN976",
"TGN998",
"TGV216",
"TGW456",
"TGY555",
"TGY848",
"THK680",
"THL577",
"THP045",
"THS062",
"THV049",
"THV280",
"THV800",
"THV849",
"THV875",
"THV899",
"THV986",
"THW055",
"THW064",
"THW065",
"THW070",
"THW118",
"THW121",
"THW175",
"THW238",
"THX499",
"THY020",
"TJA369",
"TJW513",
"TLM297",
"TLN026",
"TLN171",
"TLN464",
"TLN742",
"TLO442",
"TLO841",
"TLO892",
"TLP000",
"TLP277",
"TLY198",
"TLY311",
"TLY470",
"TLY581",
"TLY737",
"TLY808",
"TLY809",
"TLY810",
"TLY817",
"TLY950",
"TLY955",
"TLY960",
"TLY976",
"TLZ018",
"TLZ226",
"TLZ289",
"TLZ306",
"TLZ333",
"TLZ334",
"TLZ354",
"TLZ434",
"TLZ667",
"TLZ714",
"TLZ960",
"TMP578",
"TOQ622",
"TPZ976",
"TRE143",
"TRE258",
"TRJ961",
"TRJ962",
"TRJ964",
"TRJ972",
"TRJ974",
"TSF155",
"TSK354",
"TSK872",
"TSM000",
"TSM100",
"TSM114",
"TSM128",
"TSM145",
"TSM173",
"TSM176",
"TSM290",
"TSP696",
"TSV470",
"TSV881",
"TSW806",
"TSX400",
"TSX688",
"TSX902",
"TSY235",
"TSY441",
"TSY573",
"TTN786",
"TTN918",
"TTO168",
"TTO500",
"TTO501",
"TTO641",
"TTO995",
"TTP577",
"TTQ259",
"TTQ327",
"TTQ329",
"TTV033",
"TTW676",
"TTW684",
"TTW691",
"TTW697",
"TTW698",
"TTW703",
"TTW709",
"TTW710",
"TTW711",
"TTW714",
"TTW720",
"TTW721",
"TTW723",
"TTX898",
"TTX906",
"TTY468",
"TTY469",
"TTY470",
"TTY471",
"TTY474",
"TTY475",
"TTY476",
"TTY477",
"TTY747",
"TTY748",
"TTY754",
"TTY825",
"TTY880",
"TTY907",
"TTZ011",
"TTZ013",
"TTZ015",
"TTZ090",
"TTZ280",
"TTZ371",
"TTZ373",
"TTZ374",
"TTZ375",
"TTZ490",
"TTZ607",
"TTZ644",
"TTZ881",
"TUK042",
"TUK045",
"TUK139",
"TUK281",
"TUK320",
"TVA626",
"TVA908",
"TVA941",
"TVB519",
"TVB531",
"TVB547",
"TVB633",
"TVB751",
"TVB813",
"TVC451",
"TVC755",
"TWA206",
"TZQ924",
"TZR900",
"TZS586",
"TZS779",
"TZT516",
"TZT531",
"UAQ531",
"UAR009",
"UAR175",
"UFC931",
"UFL015",
"UFT378",
"UFU005",
"UFV580",
"UFV605",
"UFW759",
"UFW837",
"UFW843",
"UFX287",
"UFX889",
"UFX955",
"UFY059",
"UFY643",
"UFZ409",
"UFZ811",
"UPO269",
"UPO691",
"UPP911",
"UPP964",
"UPQ018",
"UPQ505",
"UPQ549",
"UPR910",
"UPR940",
"UPS317",
"UPS758",
"UPT969",
"UQS470",
"USA043",
"USA289",
"USA896",
"USA963",
"USA993",
"USB773",
"USE704",
"USE951",
"UVL353",
"UVL736",
"UYY987",
"UZK117",
"UZK410",
"UZK412",
"VCD407",
"VCG737",
"VCS728",
"VDV221",
"VEQ478",
"VEW759",
"VJK322",
"VKQ061",
"VZD367",
"WCN061",
"WCP327",
"WCR106",
"WCR487",
"WCR488",
"WCR489",
"WCR490",
"WCR491",
"WCR492",
"WCR494",
"WCR833",
"WCR854",
"WCS094",
"WCS172",
"WCS479",
"WCS584",
"WCS585",
"WCS586",
"WCS596",
"WCS711",
"WCS712",
"WCS713",
"WCS716",
"WCS717",
"WCS718",
"WCS719",
"WCS720",
"WCS773",
"WCT222",
"WCT224",
"WCT371",
"WCT549",
"WCT614",
"WCV190",
"WCW170",
"WCX155",
"WCX381",
"WCX823",
"WCY014",
"WCZ026",
"WCZ680",
"WCZ705",
"WDC771",
"WDD297",
"WDQ299",
"WDQ884",
"WEO829",
"WEO964",
"WEP252",
"WEP286",
"WEP297",
"WEP601",
"WEP603",
"WEP605",
"WEP859",
"WEP860",
"WEP861",
"WEP862",
"WEP898",
"WEP923",
"WEQ168",
"WEQ303",
"WEQ458",
"WEQ460",
"WEQ461",
"WEQ633",
"WEQ634",
"WEQ636",
"WEQ637",
"WEQ638",
"WEQ639",
"WEQ642",
"WEQ679",
"WEQ691",
"WEQ757",
"WER262",
"WER264",
"WER679",
"WER716",
"WFC545",
"WFC889",
"WFC931",
"WFG965",
"WFL714",
"WFQ054",
"WFQ227",
"WFQ422",
"WFR394",
"WFR490",
"WFR560",
"WFR583",
"WFR958",
"WFR970",
"WFS098",
"WFT971",
"WFU064",
"WFU141",
"WFU463",
"WFU497",
"WFV146",
"WFV517",
"WFV833",
"WFV883",
"WFW200",
"WGI789",
"WGO475",
"WGO505",
"WGO769",
"WGO772",
"WGO773",
"WGO774",
"WGO919",
"WGO920",
"WGO956",
"WGP287",
"WGP392",
"WGP433",
"WGP672",
"WGP875",
"WGQ168",
"WGQ324",
"WGQ325",
"WGQ331",
"WGQ407",
"WGQ475",
"WGQ552",
"WGQ553",
"WGQ736",
"WGQ743",
"WGQ909",
"WGQ910",
"WGQ947",
"WGQ948",
"WGQ950",
"WGQ951",
"WGQ952",
"WGQ953",
"WGQ966",
"WGR036",
"WGR109",
"WGR110",
"WGR111",
"WGR124",
"WGR138",
"WGR139",
"WGU722",
"WGX934",
"WGX965",
"WGY018",
"WGY128",
"WGY359",
"WGZ111",
"WGZ116",
"WGZ117",
"WGZ314",
"WGZ524",
"WGZ655",
"WGZ665",
"WGZ701",
"WGZ769",
"WGZ981",
"WGZ982",
"WGZ984",
"WGZ986",
"WGZ987",
"WHL593",
"WHN777",
"WHO215",
"WHO555",
"WHO675",
"WHP828",
"WLK854",
"WLK999",
"WLL119",
"WLL200",
"WLL977",
"WLM400",
"WLM564",
"WLP494",
"WLQ035",
"WLQ069",
"WLQ463",
"WLQ490",
"WLQ599",
"WLQ612",
"WLQ933",
"WLQ935",
"WLR517",
"WLR574",
"WLR796",
"WLR897",
"WLS296",
"WLS398",
"WLS399",
"WLS400",
"WLS401",
"WLS586",
"WLU707",
"WLW829",
"WLW831",
"WML253",
"WMT253",
"WMT270",
"WMT294",
"WMT324",
"WMW323",
"WMY927",
"WMZ029",
"WMZ314",
"WMZ719",
"WNK284",
"WNL680",
"WNL681",
"WNL682",
"WNL683",
"WNL684",
"WNL685",
"WNL686",
"WNL737",
"WNL740",
"WNM467",
"WNM468",
"WNM469",
"WNM482",
"WNM483",
"WNM484",
"WNM485",
"WNM632",
"WNM633",
"WNM634",
"WNM635",
"WNM641",
"WNM859",
"WNN044",
"WNN423",
"WNN424",
"WNN425",
"WNN566",
"WNN666",
"WNN740",
"WNN784",
"WNN785",
"WNN791",
"WNO056",
"WNO057",
"WNO474",
"WNO502",
"WNO522",
"WNO523",
"WNO524",
"WNO538",
"WNO570",
"WNR104",
"WNR141",
"WNR324",
"WNX100",
"WNX110",
"WNX799",
"WNY243",
"WNY934",
"WNZ007",
"WNZ842",
"WON773",
"WON774",
"WON794",
"WOS301",
"WOS328",
"WOS329",
"WOS330",
"WOS331",
"WOS383",
"WOS386",
"WOS387",
"WOS464",
"WOS471",
"WOS548",
"WOS549",
"WOS550",
"WOS551",
"WOS552",
"WOS553",
"WOS554",
"WOS593",
"WOS612",
"WOS635",
"WOS636",
"WOS637",
"WOS638",
"WOS977",
"WOT344",
"WOT530",
"WOT531",
"WOT536",
"WOT560",
"WOT703",
"WOT845",
"WOU011",
"WOU129",
"WOU205",
"WOU206",
"WOU248",
"WOU249",
"WOU250",
"WOU253",
"WOU254",
"WOU255",
"WOU256",
"WOU257",
"WOU258",
"WOU259",
"WOU260",
"WOU261",
"WOU343",
"WOU423",
"WOU443",
"WOU488",
"WOU543",
"WOU655",
"WOU656",
"WOU760",
"WOU761",
"WOU762",
"WOV004",
"WOV005",
"WOV118",
"WOV119",
"WOV150",
"WOV151",
"WOV152",
"WOV153",
"WOV154",
"WOV155",
"WOV156",
"WOV157",
"WOV215",
"WOX110",
"WOX111",
"WOX142",
"WOX290",
"WOX801",
"WOX823",
"WOY156",
"WOY971",
"WOZ209",
"WPL887",
"WPL892",
"WPL894",
"WPN137",
"WPN350",
"WPO224",
"WPO303",
"WPP007",
"WPP076",
"WPP198",
"WPQ496",
"WPQ620",
"WPQ755",
"WPT850",
"WPT866",
"WPX359",
"WQV308",
"WTN993",
"WTO819",
"WWA497",
"XFA689",
"XGC704",
"XGC833",
"XGC872",
"XGD583",
"XHB708",
"XIE015",
"XIK367",
"XJB198",
"XJB307",
"XJB331",
"XMB807",
"XVN609",
"XVU548",
"XVW770",
"XWC602",
"XXB040",
"YCK041",
"USE816",
"WFT328",
"TLY733",
"WFU010",
"EXX243",
"KYR902",
"LSY126",
"LSX711",
"WCX013",
"FSV915",
"WDS062",
"NUX063",
"SMN777",
"USE792",
"TLN434",
"SMI886",
"WOZ217",
"SMK674",
"SMG778",
"SPN087",
"SIF575",
"SKN197",
"SLI553",
"SLJ962",
"SMA776",
"SMX122",
"SNP701",
"SOD510",
"SOE311",
"SOE990",
"SOF141",
"SPR734",
"SXY915",
"SZL999",
"TBW097",
"TDL002",
"TGZ589",
"TSM476",
"TSW416",
"TSY479",
"TTY463",
"UPP988",
"USC997",
"UVK527",
"VEC786",
"VKI742",
"WCR098",
"WEP602",
"WER529",
"WLL806",
"WLM590",
"WLR146",
"WNS771",
"WOW507",
"WZH222",
"XMA904",
"TZS987",
"EQZ099",
"ERK043",
"ESS155",
"ETT474",
"EXX258",
"KYQ780",
"LSY082",
"LUL214",
"LUW853",
"NHQ774",
"NUU623",
"SBV510",
"SIS305",
"SJQ121",
"SJQ707",
"SKK652",
"SKL839",
"SKY911",
"SKZ807",
"SLG307",
"SMP203",
"SNP343",
"SNU257",
"SNV216",
"SOD629",
"SOE844",
"SPC015",
"SPD622",
"SPL762",
"SPP862",
"SPP915",
"SPR107",
"SQL727",
"SQX023",
"SWL811",
"SWP979",
"SXD370",
"SXH767",
"SZA268",
"TDK355",
"TLO067",
"TLO654",
"TLX314",
"TZS507",
"UFU437",
"UPR528",
"UPS589",
"VFC690",
"WCM153",
"WCZ482",
"WEQ261",
"WGO901",
"WGZ661",
"WLQ464",
"WLY688",
"WMZ908",
"WOT704",
"WOU788",
"WPR002",
"WPT779",
"XGC781",
"XGY018",
"XYD084",
"SMA735",
"SMK266",
"WHQ817",
"WTT057",
"BW0997",
"ESS243",
"EXZ797",
"GDW018",
"GZZ204",
"GZZ205",
"LMN088",
"NHP441",
"NHQ015",
"SHM193",
"SKL949",
"SKM865",
"SKN501",
"SMD278",
"SMT006",
"SNR264",
"SNU527",
"SOD455",
"SOE653",
"SOS515",
"SPD613",
"SPL998",
"SPM305",
"SPO264",
"SPO578",
"SPO954",
"SPP328",
"SPT277",
"SPW925",
"SQL104",
"SQL758",
"SQW801",
"SVC166",
"SWO572",
"SXB415",
"SXX113",
"SXY262",
"SYT450",
"SYT776",
"SYU095",
"SZV157",
"TAL720",
"TBL114",
"TFP864",
"TGK646",
"TLO620",
"TRE999",
"TSV410",
"TSV653",
"TSV684",
"TSW683",
"TTO085",
"TTP075",
"TTQ152",
"TZS689",
"UFT055",
"UFV117",
"UFX761",
"UPP998",
"UPQ971",
"UPT652",
"VAK018",
"VCH179",
"WCR192",
"WCR585",
"WCT300",
"WCV201",
"WCV518",
"WCW393",
"WDY002",
"WER737",
"WFQ364",
"WFT330",
"WFT402",
"WGO404",
"WGZ983",
"WLS599",
"WMZ440",
"WON777",
"WON913",
"WOU789",
"WPQ698",
"WTC300",
"XHB668",
"SPQ220",
"WFV960",
"GZZ425",
"SLH861",
"SML568",
"SOO112",
"SPM569",
"SSA153",
"SXZ821",
"SZP245",
"WFQ117",
"ESM422",
"MYR599",
"MYR649",
"NHP186",
"PMV424",
"SLG914",
"SMM608",
"SON162",
"SQL178",
"SXX618",
"TDL018",
"TEW196",
"TUK200",
"UFT916",
"UFX377",
"UPO959",
"VDW342",
"WCV308",
"WCV318",
"WCV357",
"WDG847",
"WGO770",
"WLL953",
"WLQ613",
"WNX193",
"TAS959",
"SKX987",
"WMY830",
"SMB482",
"PMV033",
"XVO197",
"WMA951",
"UFT893",
"TSY545",
"SXB365",
"SLJ176",
"TDS001",
"VDF774",
"TSY395",
"TZS916",
"SLG165",
"KRM036",
"TMW814",
"WEO936",
"SJQ741",
"TDL385",
"USC231",
"SPY151",
"WGQ482",
"FVL297",
"SOR619",
"UFX783",
"LZN289",
"WGY974",
"TTZ017",
"WGO771",
"WGO554",
"SXG932",
"TSW661",
"SOO114",
"UFU485",
"FUZ436",
"SYS756",
"TBL332",
"SYS467",
"XXA895",
"VEO487",
"TTF558",
"EXX643",
"SQW952",
"THU815",
"TTY472",
"USE589",
"WGQ737",
"WGQ908",
"WLK233",
"XGC848",
"WOU792",
"SXH637",
"INI056",
"WCR822",
"WPP111",
"WMT327",
"WCZ058",
"TWA108",
"PPK154",
"NOX025",
"WGP043",
"LZN829",
"PMV927",
"SXX619",
"SOO125",
"SKM276",
"WNN576",
"SMA382",
"WNL739",
"WOT537",
"UFW834",
"WEP864",
"WCS547",
"USB778",
"UFW124",
"UPT040",
"UPT649",
"UFT580",
"UFU128",
"TSZ586",
"TUK063",
"TZS585",
"TZR406",
"TTZ126",
"TTZ552",
"TRM872",
"TLZ747",
"TSW534",
"TSO651",
"TLZ332",
"TLZ559",
"TLZ713",
"TFQ822",
"SXX607",
"SXT702",
"TER426",
"SZU415",
"STS060",
"SRF177",
"SQL358",
"SPL629",
"SMN502",
"SLG142",
"SKN674",
"SKM295",
"GVX949",
"GVX941",
"GDW002",
"ETT328",
"EQZ787",
"WOT118",
"WOU505",
"WOO030",
"WNX111",
"WNM642",
"WGL280",
"WMT265",
"WFU046",
"WEQ758",
"WGZ985",
"TSU588",
"PMX405",
"NOY444",
"EQZ484",
"TVB179",
"NHP446",
"XVZ148",
"SYT891",
"WTM057",
"SKN248",
"SQZ452",
"SNX630",
"SON426",
"SXY263",
"UFX570",
"THP197",
"SMP569",
"UPR308",
"TFT479",
"SON935",
"WFV583",
"WGR038",
"WHO676",
"WCW841",
"WEQ559",
"WDC072",
"TTP786",
"WCM254",
"TLN653",
"TAQ100",
"SOE814",
"EXX890",
"NHR028",
"SKV560",
"FSV961",
"ETT475",
"ZNM111",
"XHB679",
"ETT471",
"SOR976",
"SVB211",
"ETT473",
"WMT272",
"SUL743",
"TFP387",
"THY573",
"KSO576",
"TLY819",
"SKM346",
"JOX098",
"SIT806",
"UFU028",
"NHR217",
"PRZ519",
"LSY127",
"UPP043",
"WLU073",
"INI009",
"NUV141",
"NUX724",
"SKK961",
"SWL717",
"UQZ377",
"SKL145",
"SPO573",
"UFW249",
"SZY299",
"SOS310",
"WGQ972",
"UFW838",
"LUL139",
"NUX379",
"ETT943",
"ETT944",
"WCT730",
"LZN024",
"LZM876",
"LJT254",
"KSP813",
"WGQ968",
"TGK424",
"WGR037",
"XXB204",
"XVY971",
"WCO536",
"SZN868",
"EQX558",
"USE980",
"SPP654",
"FSW136",
"NSQ633",
"TSX427",
"TSY553",
"SJR914",
"TLM731",
"STI806",
"KMY694",
"THV868",
"TTZ279",
"WFC899",
"WCS522",
"LTK782",
"THR622",
"SLE617",
"EXX247",
"EXZ567",
"SLE650",
"FVL540",
"SZX844",
"SXX464",
"GEV039",
"WGO635",
"USA151",
"UFX638",
"XGC992",
"UFY910",
"WLR766",
"TZS915",
"WNO501",
"TWA086",
"WOU252",
"SLE643",
"TBZ004",
"PSY124",
"SOD289",
"TTZ483",
"SWO237",
"TSZ915",
"WLN199",
"LZN589",
"LUM748",
"WOX207",
"SXR953",
"SMI874",
"SOQ584",
"NUX427",
"SWM842",
"WOY452",
"WGQ076",
"WFV581",
"TEQ905",
"TBK739",
"SNP450",
"SMN376",
"SKL901",
"UPQ732",
"SZU604",
"TUL672",
"XJA641",
"XIE290",
"SPS959",
"XJB290",
"XVB189",
"TRD501",
"WCW616",
"TTO524",
"XVM381",
"ETT947",
"TTP245",
"FST864",
"XIE513",
"SKN204",
"WGQ329",
"LZO596",
"ESU153",
"JOV533",
"NHR339",
"NHU500",
"WLQ144",
"TGM372",
"KSR305",
"TSO517",
"SPP727",
"KSP812",
"WMY533",
"WPT984",
"WMZ407",
"EYX606",
"EQP710",
"EQZ609",
"WFQ366",
"WFQ363",
"ESS302",
"ESS310",
"ESS280",
"UFT810",
"TRN525",
"TAM555",
"WOT828",
"TFR425",
"TGM608",
"NOK117",
"SYS975",
"SMA315",
"TJK020",
"WNZ407",
"SOP606",
"UPR250",
"SLG332",
"TSM050",
"SKN033",
"WOZ122",
"EXZ257",
"WNV637",
"FST991",
"NOL591",
"SKL197",
"FSV095",
"NOK040",
"NHP362",
"TFU569",
"UFZ613",
"SXH548",
"WEP290",
"WCV822",
"WCS890",
"WGQ956",
"KSP335",
"WFW101",
"JKV112",
"NHP361",
"NOK336",
"NOL344",
"FSV078",
"EXZ796",
"LRN278",
"SPS218",
"LUW421",
"SSR494",
"TZT520",
"SYT674",
"STS555",
"SOO380",
"JOV138",
"KNZ011",
"WCX570",
"UPS494",
"WDC756",
"LZM801",
"PMV392",
"WLL115",
"TGK436",
"NOX320",
"NUW854",
"WOY881",
"WMN737",
"WPL573",
"WNV638",
"WNV641",
"WNV639",
"WNV636",
"XIE652",
"UPO495",
"WPL891",
"WPL889",
"WPL890",
"WPL682",
"WPL888",
"WPP208",
"WNV374",
"WOU794",
"WPL893",
"WPP034",
"WNV574",
"FUZ421",
"FUZ423",
"KQR566",
"KSQ527",
"LMM951",
"KQR364",
"KQR440",
"WPU044",
"GDW201",
"GVX945",
"JSL427",
"KQR353",
"JSL424",
"GUU487",
"WPU043",
"TLZ435",
"TLZ650",
"TSM051",
"THX340",
"SKZ067",
"PSY415",
"SPO841",
"SPP664",
"SMO964",
"FSV216",
"WFQ365",
"EXZ634",
"WPL572",
"VDK365",
"SPT526",
"SLG760",
"NHT073",
"LZM475",
"WOU402",
"UFT398",
"USA849",
"WNZ719",
"WPL571",
"WNV642",
"XGC762",
"WCW819",
"VKI726",
"TLN633",
"SPP870",
"SPO751",
"SHT248",
"SON747",
"NUX061",
"SKM572",
"SBL231",
"PRZ813",
"LUM578",
"LLQ775",
"LLQ774",
"LZM397",
"GET398",
"NOK928",
"GET396",
"GEU151",
"FST862",
"FST863",
"ESL510",
"FST633",
"EQZ528",
"XXB091",
"EXX564",
"SZQ701",
"TBK733",
"WFT319",
"SPN790",
"EP605",
"FVL937",
"SZQ095",
"UZK108",
"WCZ787",
"ESM833",
"LCN196",
"WLK613",
"WCZ174",
"GUR793",
"TTQ898",
"TSM988",
"SPP603",
"SMN560",
"WMZ069",
"SDM692",
"SBL130",
"MYR426",
"LLO885",
"KMZ841",
"JUY975",
"IWR575",
"EYY803",
"MYR698",
"SYT811",
"EYX808",
"POZ673",
"ERL150",
"GUV233",
"NWV206",
"MYY426",
"WMZ119",
"EYY003",
"TAM425",
"GUW400",
"EYX800",
"EYX817",
"EYX807",
"EYX818",
"FVL847",
"WHX332",
"WHX316",
"FVL859",
"PMW424",
"TVB113",
"JTX502",
"WOT162",
"THW162",
"PRZ372",
"PRY730",
"LQK133",
"LJV247",
"UZK193",
"WCS129",
"TTY277",
"TGK422",
"SXX703",
"SZN798",
"WFQ040",
"SVP332",
"SXR956",
"WFG998",
"SPN870",
"SPR324",
"SMO498",
"SMO221",
"SLH146",
"SKZ097",
"SKN317",
"SVC040",
"SBK873",
"POZ477",
"SIG257",
"PMT742",
"SOP722",
"SKZ078",
"SKU400",
"PWR182",
"LSY735",
"JTR366",
"JUY784",
"JTR364",
"GUV499",
"GUV463",
"FVM406",
"FVL956",
"FST501",
"FST497",
"FST499",
"FST496",
"FST498",
"FST878",
"FST500",
"FST493",
"FST495",
"FST494",
"FST491",
"FST490",
"ESM696",
"ESM697",
"ESM695",
"ESL996",
"ESM694",
"EQZ012",
"EQZ007",
"EQZ010",
"EQZ006",
"EQZ004",
"EQZ009",
"EQZ011",
"EQZ008",
"EQZ003",
"SPQ162",
"WOU653",
"WOU654",
"WOU650",
"WOU652",
"WOU487",
"WOU651",
"WOU649",
"WNX599",
"WNX598",
"WNX384",
"WOO031",
"WNX382",
"WNX383",
"WNX381",
"WNU953",
"WGZ130",
"WGY559",
"WFC890",
"VCG083",
"TZS367",
"TSS365",
"TLZ391",
"TLZ510",
"TLZ254",
"WRD200",
"WPT857",
"SMK603",
"WFI873",
"SKP197",
"SKN723",
"SKL381",
"EXX398",
"NSX212",
"SXZ659",
"TLZ234",
"SQI388",
"SPL633",
"SQI544",
"SOR782",
"WOT660",
"WNX955",
];
const formatoPlacaRegExp = /^[A-Z]{3}[0-9]{3}$/;

/* =====================================================
    GESTI√ìN DEL ESTADO APROBADO/RECHAZADO
===================================================== */

function seleccionarEstado(estado) {
    // Limpiar errores anteriores
    document.getElementById("errorEstado").textContent = "";

    // Actualizar la variable global
    estadoSeleccionado = estado;

    const btnAprobado = document.getElementById("btnAprobado");
    const btnRechazado = document.getElementById("btnRechazado");
    
    // Quitar la clase 'selected' de ambos
    btnAprobado.classList.remove('selected');
    btnRechazado.classList.remove('selected');

    // A√±adir la clase 'selected' al bot√≥n que se presion√≥
    if (estado === 'APROBADO') {
        btnAprobado.classList.add('selected');
    } else if (estado === 'RECHAZADO') {
        btnRechazado.classList.add('selected');
    }
}

/* =====================================================
    GENERAR LOS D√çAS
===================================================== */

function generarDias() {

    let y = year.value;
    let m = month.value;
    let c = contrato.value.toUpperCase().trim();
    let r = ruta.value.toUpperCase().trim();
    let resp = responsable.value.toUpperCase().trim(); 

    errorResp.innerHTML = ""; 
    errorY.innerHTML = "";
    errorM.innerHTML = "";
    errorR.innerHTML = "";
    errorC.innerHTML = "";

    let err = false;
    
    if (!resp) { errorResp.innerHTML = "Responsable obligatorio"; err = true; } 

    if (!y) { errorY.innerHTML = "A√±o obligatorio"; err = true; }
    if (!m) { errorM.innerHTML = "Mes obligatorio"; err = true; }
    if (!c) { errorC.innerHTML = "Contrato / OC es obligatorio"; err = true; }

    // Nueva expresi√≥n regular: Inicia con Letra [A-Z], luego guion (-), y luego cualquier cosa (.*)
    let regRuta = /^[A-Z]-.+$/; 
    
    if (r.length > 0 && !regRuta.test(r)) { 
        errorR.innerHTML = "Formato inv√°lido. Debe ser: Letra - (y luego cualquier cosa). Ej: U-001";
        err = true;
    }
    
    if (r.length === 0) {
        errorR.innerHTML = "N√∫mero de Ruta obligatorio";
        err = true;
    }

    if (err) return;
    
    responsable.value = resp;
    contrato.value = c;
    ruta.value = r;

    const meses = {
        "Enero":1,"Febrero":2,"Marzo":3,"Abril":4,"Mayo":5,"Junio":6,
        "Julio":7,"Agosto":8,"Septiembre":9,"Octubre":10,"Noviembre":11,"Diciembre":12
    };

    let nMes = meses[m];
    let dias = new Date(y, nMes, 0).getDate();

    daysContainer.innerHTML = `
        <div class="header-row">
            <div>FECHA DE SERVICIO</div>
            <div>PLACA RECORRIDO 1</div>
            <div>PLACA RECORRIDO 2</div>
            <div>OBSERVACI√ìN</div>
        </div>
    `;

    for (let d = 1; d <= dias; d++) {

        let fecha = `${d}/${nMes}/${y}`;

        daysContainer.innerHTML += `
            <div class="row">
                <div><b>${fecha}</b></div>

                <div>
                    <input class="placa" data-dia="${d}" placeholder="PLACA 1">
                    <div class="msg" id="msg1-${d}"></div>
                </div>

                <div>
                    <input class="placa" data-dia2="${d}" placeholder="PLACA 2">
                    <div class="msg" id="msg2-${d}"></div>
                </div>

                <div>
                    <input class="obs" data-obs="${d}" placeholder="OBSERVACI√ìN">
                </div>
            </div>
        `;
    }

    activarValidaciones();
}

/* =====================================================
    VALIDAR PLACAS EN TIEMPO REAL
===================================================== */

function activarValidaciones() {

    document.querySelectorAll(".placa").forEach(inp => {

        inp.addEventListener("input", function() {

            let val = this.value.toUpperCase().replace(/[^A-Z0-9]/g, "");
            this.value = val;

            let id = this.dataset.dia ? `msg1-${this.dataset.dia}` : `msg2-${this.dataset.dia2}`;
            let msgBox = document.getElementById(id);
            
            if (val.length === 0) {
                 msgBox.textContent = "";
            } else if (!formatoPlacaRegExp.test(val)) {
                msgBox.textContent = "FORMATO: XXX999";
            } else if (!placasValidas.includes(val)) {
                msgBox.textContent = "PLACA NO AUTORIZADA";
            } else {
                msgBox.textContent = "";
            }
        });

    });

}

/* =====================================================
    GUARDAR EN SUPABASE
===================================================== */

async function guardarDatos() {

    // 1. VALIDACI√ìN DE ESTADO OBLIGATORIO
    if (!estadoSeleccionado) {
        document.getElementById("errorEstado").textContent = "Debe seleccionar APROBADO o RECHAZADO.";
        alert("‚ùå ERROR: Debe seleccionar APROBADO o RECHAZADO.");
        return;
    }

    const responsableV = responsable.value.toUpperCase();
    const yearV = year.value;
    const monthV = month.value.toUpperCase();
    const contratoV = contrato.value.toUpperCase();
    const rutaV = ruta.value.toUpperCase();
    let obsGeneralV = obsGeneral.value.toUpperCase();
    
    // 2. Validaci√≥n de campos principales
    if (!responsableV || !yearV || !monthV || !contratoV || !rutaV) {
        alert("TODOS LOS CAMPOS PRINCIPALES SON OBLIGATORIOS (incluyendo Responsable).");
        return;
    }
    
    // 3. Validaci√≥n estricta de formato de placa
    let errorPlacaEncontrado = false;
    document.querySelectorAll(".placa").forEach(inp => {
        let placa = inp.value.toUpperCase().trim();
        
        if (placa.length > 0) {
            
            if (!formatoPlacaRegExp.test(placa)) {
                errorPlacaEncontrado = true;
                inp.style.border = '2px solid red'; 
            } else {
                inp.style.border = '1px solid #ccc';
            }
        }
    });

    if (errorPlacaEncontrado) {
        alert("‚ùå ERROR: Una o m√°s placas tienen el formato incorrecto. Deben ser 3 letras y 3 n√∫meros (Ej: XXX999).");
        return; 
    }

    // Continuar si todas las validaciones pasan
    let registros = [];

    // Ajustar obsGeneralV si est√° vac√≠o
    if (obsGeneralV === "") obsGeneralV = null; 

    document.querySelectorAll(".row").forEach(row => {

        let fechaTexto = row.querySelector("b").innerText;
        let [dia, mes, anio] = fechaTexto.split("/");
        let fechaISO = `${anio}-${String(mes).padStart(2,'0')}-${String(dia).padStart(2,'0')}`;

        let placa1 = row.querySelector("input[data-dia]")?.value.toUpperCase() || null;
        let placa2 = row.querySelector("input[data-dia2]")?.value.toUpperCase() || null;
        let obs = row.querySelector("input[data-obs]")?.value.toUpperCase() || null;

        if (placa1 === "") placa1 = null;
        if (placa2 === "") placa2 = null;
        if (obs === "") obs = null;

        registros.push({
            a√±o: parseInt(yearV),
            mes: monthV,
            numero_ruta: rutaV,
            numero_de_contrato_oc: contratoV,
            fecha_servicio: fechaISO,
            placa_recorrido_1: placa1,
            placa_recorrido_2: placa2,
            observacion: obs,
            observacion_general: obsGeneralV,
            // üí• NOMBRES DE COLUMNA AJUSTADOS A LO QUE TIENES EN SUPABASE (May√∫sculas)
            responsable: responsableV, 
            estado: estadoSeleccionado 
            // ==========================================================
        });

    });

    console.log(`üì§ Enviando ${estadoSeleccionado} a Supabase:`, registros);

    const { data, error } = await client
        .from("recepcion_certificados")
        .insert(registros);

    if (error) {
        console.error("‚ùå ERROR EN SUPABASE:", error);
        alert("‚ùå Error al guardar. Revisa la consola.");
        return;
    }

    alert(`‚úÖ Datos guardados como ${estadoSeleccionado} exitosamente en Supabase`);
    window.location.reload(); 
}
</script>

</body>
</html>

